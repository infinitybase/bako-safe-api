version: '3.8'

services:
 socket-server:
  container_name: ${SOCKET_NAME}
  build:
   context: .
   dockerfile: Dockerfile
  working_dir: /socket
  ports:
   - '${SOCKET_PORT}:${SOCKET_PORT}'
  environment:
   # DATABASE
   - DATABASE_HOST=${DATABASE_HOST}
   - DATABASE_PORT=${DATABASE_PORT}
   - DATABASE_USERNAME=${DATABASE_USERNAME}
   - DATABASE_PASSWORD=${DATABASE_PASSWORD}
   - DATABASE_NAME=${DATABASE_NAME}

   # ASSETS
   - UI_URL=${UI_URL}
   - API_URL=${API_URL}

   # SOCKET
   - SOCKET_PORT=${SOCKET_PORT}
   - SOCKET_NAME=${SOCKET_NAME}
   - SOCKET_TIMEOUT_DICONNECT=${SOCKET_TIMEOUT_DICONNECT}

   # REDIS
   - REDIS_URL_READ=${REDIS_URL_READ}
   - REDIS_URL_WRITE=${REDIS_URL_WRITE}

  restart: always
  healthcheck:
   test: ['CMD', 'wget', '--spider', '--quiet', 'http://localhost:3001/health']
   interval: 10s
   timeout: 5s
   retries: 5

  networks:
   - bako-network

networks:
 bako-network:
  external: true
